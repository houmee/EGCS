/******************************************************************** 
修改时间:        2016/04/06 20:57
文件名称:        Tools.cpp
文件作者:        huming 
=====================================================================
功能说明:        文件操作 
--------------------------------------------------------------------- 
版本编号:        
--------------------------------------------------------------------- 
其他说明:         
*********************************************************************/
#include "Tools.h"

//---------------------------------------------------------------------------
//功能：默认构造函数
//---------------------------------------------------------------------------//
CTools::CTools()
{
  m_OutputFilePtr = NULL;
}

//---------------------------------------------------------------------------
//功能：初始化工具
//---------------------------------------------------------------------------//
void CTools::InitTools()
{
  //打开输出文件名
  fopen_s(&m_OutputFilePtr,".\\Data\\EGCSLog.txt","w");
  if (m_OutputFilePtr == NULL )
  {
    fprintf(stderr,"Cannot open output file %s\n", "EGCSLog.txt");
    exit(-1);
  }
}

//---------------------------------------------------------------------------
//功能：关闭工具
//---------------------------------------------------------------------------//
void CTools::CloseTools(int select_item)
{
   fclose(m_OutputFilePtr);
}

//---------------------------------------------------------------------------
//功能：初始化报告
//---------------------------------------------------------------------------//
void CTools::InitReport()
{
  fseek(m_OutputFilePtr, 0L, SEEK_SET);
  WriteLine(1);
  fprintf(m_OutputFilePtr,"\n ++++++++++++++++++++EGCS+++++++++++++++++++++++\n");
  fprintf(m_OutputFilePtr," -------------------------------------------------\n");

  fprintf(m_OutputFilePtr," -------------------------------------------------\n");
  WriteLine(1);
  fflush(m_OutputFilePtr);
}

//---------------------------------------------------------------------------
//功能：输出换行
//---------------------------------------------------------------------------//
void CTools::WriteLine(int skipcount)
{
  for (int i=0; i<skipcount; i++)
    fprintf(m_OutputFilePtr,"\n");
}

//---------------------------------------------------------------------------
//功能：输出字符串
//---------------------------------------------------------------------------//
void CTools::WriteString(char *ch, int repcount)
{
  for (int i=0; i<repcount; i++)
    fprintf(m_OutputFilePtr,"%s", ch);
}

//---------------------------------------------------------------------------
//功能：输出运行文件
//---------------------------------------------------------------------------//
void CTools::Report()
{
  WriteString("-",80);
  WriteLine(1); 
}